<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verify Certificate • Nater's Learning Hub</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Backendless SDK -->
  <script src="https://api.backendless.com/sdk/js/latest/backendless.min.js"></script>

  <style>
    :root{
      --primary-color:#ff6b6b;
      --secondary-color:#48e5c2;
      --dark-bg:#1e1e2d;
      --card-bg:#2a2a3e;
      --text-color:#e0e0e0;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      font-family:'Poppins',sans-serif;
      background:linear-gradient(135deg,#1e1e2d 0%,#000 100%);
      color:var(--text-color);
      min-height:100vh;
      overflow-x:hidden;
      text-align:center;
      padding:30px;
    }
    h1{
      color:var(--secondary-color);
      margin-bottom:25px;
      font-size:2rem;
      text-shadow:0 0 10px var(--secondary-color);
    }
    .main-container{
      max-width:600px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      gap:20px;
    }
    .card{
      background:var(--card-bg);
      padding:30px 20px;
      border-radius:20px;
      box-shadow:0 10px 25px rgba(0,0,0,0.4);
      border:2px solid rgba(255,255,255,0.1);
    }
    .card input{
      width:100%;
      padding:12px;
      border:none;
      border-radius:10px;
      background:rgba(255,255,255,0.05);
      color:var(--text-color);
      margin-bottom:15px;
      font-size:1rem;
    }
    .card input:focus{
      outline:none;
      box-shadow:0 0 10px var(--secondary-color);
      background:rgba(72,229,194,0.1);
    }
    .card button{
      width:100%;
      padding:12px;
      font-size:1rem;
      font-weight:600;
      color:#1e1e2d;
      background:linear-gradient(90deg,var(--primary-color),var(--secondary-color));
      border:none;
      border-radius:10px;
      cursor:pointer;
      transition:0.3s;
      box-shadow:0 4px 15px rgba(72,229,194,0.4);
    }
    .card button:hover{
      background:linear-gradient(90deg,#ff5252,#35c9a8);
      box-shadow:0 6px 20px rgba(72,229,194,0.6);
    }
    #result{
      margin-top:20px;
      padding:20px;
      border-radius:15px;
      text-align:left;
      box-shadow:0 8px 20px rgba(72,229,194,0.3);
      background:rgba(42,42,62,0.9);
      border-left:5px solid var(--secondary-color);
      font-size:1rem;
    }
    #result.invalid{
      border-left:5px solid #ff6b6b;
    }
    @media(max-width:768px){
      .card{padding:25px 15px;}
      h1{font-size:1.8rem;}
    }
  </style>
</head>
<body>

  <h1>Verify Certificate</h1>

  <div class="main-container">
    <div class="card">
      <input id="certInput" type="text" placeholder="Enter Certificate Code" />
      <button onclick="verifyCert()"><i class="fas fa-check"></i> Verify</button>
      <div id="result">Enter a certificate code to check its validity.</div>
    </div>
  </div>

  <script>
    // Initialize Backendless
    Backendless.initApp(
      "EC3F680C-888B-4849-A309-C6BBA192EF6E", // App ID
      "F2685256-D127-4363-B348-94D386889B02"  // API Key
    );

    // Auto-check QR ?code=
    window.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const codeFromURL = params.get('code');
      if(codeFromURL){
        document.getElementById('certInput').value = codeFromURL;
        verifyCert();
      }
    });

    function verifyCert(){
      const code = document.getElementById('certInput').value.trim();
      const resultBox = document.getElementById('result');
      if(!code){
        resultBox.innerHTML = 'Please enter a certificate code.';
        resultBox.classList.add('invalid');
        return;
      }
      resultBox.innerHTML = 'Checking...';
      resultBox.classList.remove('invalid');

      const queryBuilder = Backendless.DataQueryBuilder.create()
        .setWhereClause(`certCode = '${code}'`);

      Backendless.Data.of('Certificates').find(queryBuilder)
      .then(records => {
        if(records.length > 0){
          const rec = records[0];
          resultBox.innerHTML = `
            <p><strong>Student:</strong> ${rec.name}</p>
            <p><strong>Course:</strong> ${rec.course}</p>
            <p><strong>Date:</strong> ${rec.date}</p>
            <p><strong>Certificate Code:</strong> ${rec.certCode}</p>
            <p><strong>Status:</strong> ✅ Valid</p>
          `;
          resultBox.classList.remove('invalid');
        } else {
          resultBox.innerHTML = '❌ No record found for this certificate code.';
          resultBox.classList.add('invalid');
        }
      })
      .catch(err=>{
        resultBox.innerHTML = `⚠️ Error: ${err.message}`;
        resultBox.classList.add('invalid');
      });
    }
  </script>

</body>
</html>